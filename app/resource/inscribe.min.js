(()=>{var __webpack_modules__={436:(e,a)=>{e.exports=function(e,a,n){const t=`\n        <div class="cover-container">\n            <div class="cover-header">\n                <h1 class="collection-name">${e}</h1>\n                <h2 class="item-id">Item #${a}</h2>\n            </div>\n            <div class="cover-controls">\n                <button id="playButton" class="play-button">Play</button>\n            </div>\n            <div class="cover-details">\n                <div class="detail-item">\n                    <span class="label">Instrument:</span>\n                    <span class="value">${n.selectedInstrument}</span>\n                </div>\n                <div class="detail-item">\n                    <span class="label">EDO:</span>\n                    <span class="value">${n.selectedEDO}-tone</span>\n                </div>\n                <div class="detail-item">\n                    <span class="label">Tone Shift:</span>\n                    <span class="value">${n.toneshift} steps</span>\n                </div>\n                <div class="detail-item">\n                    <span class="label">Playback Speed:</span>\n                    <span class="value">x${n.playbackSpeed.toFixed(2)}</span>\n                </div>\n            </div>\n            \n        </div>\n        <style>\n            .cover-container {\n                width: 90vw;\n                max-width: 1200px;\n                margin: 5vh auto;\n                padding: clamp(20px, 5vw, 60px);\n                background: ${(()=>{const e=["#e9d5ff","#bfdbfe","#bbf7d0","#fed7aa","#fecaca"];return e[("number"==typeof n.toneshift?Math.abs(n.toneshift+n.selectedEDO):Math.floor(Math.random()*e.length))%e.length]})()};\n                box-shadow: 0 20px 40px rgba(0,0,0,0.15);\n                border-radius: clamp(12px, 2vw, 24px);\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                position: fixed;\n                top: 0;\n                left: 50%;\n                transform: translateX(-50%);\n            }\n            .cover-header {\n                text-align: center;\n            }\n            .collection-name {\n                font-size: clamp(1.8rem, 4vw, 3rem);\n                color: #2c3e50;\n                text-shadow: 1px 1px 2px rgba(0,0,0,0.1);\n                word-wrap: break-word;\n            }\n            .item-id {\n                font-size: clamp(1.2rem, 3vw, 1.8rem);\n                color: #7f8c8d;\n            }\n            .cover-details {\n                display: grid;\n                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n                gap: clamp(15px, 3vw, 30px);\n                margin: clamp(20px, 4vw, 40px) 0;\n            }\n            .detail-item {\n                padding: clamp(10px, 2vw, 20px);\n                background: rgba(255,255,255,0.8);\n                border-radius: clamp(8px, 1.5vw, 16px);\n                text-align: center;\n                box-shadow: 0 4px 6px rgba(0,0,0,0.05);\n                transition: transform 0.2s ease;\n            }\n            .detail-item:hover {\n                transform: translateY(-2px);\n            }\n            .label {\n                display: block;\n                font-size: clamp(0.8rem, 1.5vw, 1rem);\n                color: #95a5a6;\n                margin-bottom: clamp(4px, 1vw, 8px);\n                text-transform: uppercase;\n                letter-spacing: 1px;\n            }\n            .value {\n                font-size: clamp(1rem, 2vw, 1.4rem);\n                color: #34495e;\n                font-weight: bold;\n                word-wrap: break-word;\n            }\n            .cover-controls {\n                text-align: center;\n            }\n            .play-button {\n                padding: clamp(10px, 2vw, 15px) clamp(20px, 4vw, 40px);\n                font-size: clamp(1rem, 2vw, 1.4rem);\n                background: #2c3e50;\n                color: white;\n                border: none;\n                border-radius: clamp(6px, 1vw, 12px);\n                cursor: pointer;\n                transition: all 0.3s ease;\n                box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n            }\n            .play-button:hover {\n                background: #34495e;\n                transform: translateY(-2px);\n                box-shadow: 0 6px 8px rgba(0,0,0,0.15);\n            }\n            .play-button:disabled {\n                background: #95a5a6;\n                cursor: not-allowed;\n                transform: none;\n                box-shadow: none;\n            }\n            #Status {\n                margin-top: clamp(8px, 1.5vw, 15px);\n                color: #7f8c8d;\n                font-size: clamp(0.9rem, 1.5vw, 1.1rem);\n            }\n            @media (max-width: 480px) {\n                .cover-container {\n                    width: 95vw;\n                    margin: 2.5vh auto;\n                }\n                .cover-details {\n                    grid-template-columns: 1fr;\n                }\n            }\n        </style>\n    `;window.addEventListener("load",(()=>{document.body.innerHTML+=t}))}}},__webpack_module_cache__={};function __webpack_require__(e){var a=__webpack_module_cache__[e];if(void 0!==a)return a.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}var __webpack_exports__={};const scriptTag=document.getElementsByTagName("script")[0],contentId=scriptTag?scriptTag.getAttribute("id"):null,collection=scriptTag?scriptTag.getAttribute("collection"):null,itemId=scriptTag?scriptTag.getAttribute("item-id"):null,SRC_MIDI="/content/"+contentId,TONEJS_URL="/content/6f6f0fa29e7463db53c5514cafb7a7943cb42786557cb230b3655199e32d981di0",MIDI_URL="/content/5ebeb03cd5de042e04dfec23eb9c3e1135f7527380ba0606bc48f8a35972d31fi0",baseURL="/content/",SAMPLE_URL={A0:baseURL+"049031d90005955919bd06b145a9f75fd8b19c76b5f5924aa0f24fcaf1f9bc2ei0",C1:baseURL+"2c800dc8972a02c6c549ff2cdd0ae436567a60170277150f7a9c2d7470458cfdi0","D#1":baseURL+"62d7e88fc146c32b60b4b212030ed03c543817fb4d480f2a7eeba6767f580b38i0","F#1":baseURL+"cdb07ceb18f0e73d88d0e7955c7ceddca0c28319aadca482ff7b0c4779e4e757i0",A1:baseURL+"2385e68cee6dd757764970a01f3648f877187353f113e04ed964b97a066f197di0",C2:baseURL+"2ef2e3a0cdab0a13911debaad4630c07550b7a191e89b49965a5e431e6416770i0","D#2":baseURL+"fc15b1ae25e7a8660fd0fa5d951dff7950fe83390b3adeac74a3087f8eb0332ci0","F#2":baseURL+"caf1685a08ce39a133e62d5cf73382b8c11eda2e53a56d8dbd287ddc33d276b6i0",A2:baseURL+"a38d215f1869ae55edc5a6e83af3c70297c65d5725b2ebb597fe6b775b55436ei0",C3:baseURL+"28f398b5e5ffa2d654eddc4e037371b370689f58fa135a8812ea0c21bf5002b4i0","D#3":baseURL+"002bc0850188f3ff7f8fd39c26e0c2565e73076fefaa5c08d029e5562dce1d98i0","F#3":baseURL+"be569d1e3e312224307beb6d7add41b75f5f06d3b0c3c738eefecc086825e6c0i0",A3:baseURL+"0405214d575adb7fee544a5e5ec2c1d7c80aeb7dbba05458d294dcf6513ad31ai0",C4:baseURL+"09f4b04007b54fd4191aa1a261bbc6484da673279c6b9a70a3c0d3e9ece31de7i0","D#4":baseURL+"fed7d3c18849a3e62ac708de6398d7144076f3022a60e25808961459e1442d2di0","F#4":baseURL+"2e2eafd7a3d68227f0585f408bd5a0d2c36f92ff63fb812c50563cc750d032f9i0",A4:baseURL+"2621d5de4230faeb35ddfc6e16d5c4652a1d9e4cf273d87dc82f722e92a84dd9i0",C5:baseURL+"8b6d4474283b133d33199860e89fdd2f8bbe3b2e0a1c6227675801f0cb102c86i0","D#5":baseURL+"ded897e98ef30d4bd934683e03dca57f02a0a4dcc5de2ebede2b0dfdafc2ef53i0","F#5":baseURL+"4e5a554be460dcc34484ae5f981d3b997f323bfe34fcda6cc30d73301bf7f6e0i0",A5:baseURL+"a7d21200577fd0716cbeaec18f91747a24057cfd922c8193a899fb3f01be7954i0",C6:baseURL+"2903b6415a96a68da3c5822140160ff0d1f6bca6aafef370098e3ebfe9f0e2a0i0","D#6":baseURL+"070410c9efec4d6c174198380278b7dd3aff8d60150916f7126034e470661c29i0","F#6":baseURL+"0cbd25420068c9c9ad66047e2e3f22751677a624c19244a12cb906f2b07a1346i0",A6:baseURL+"501c5e9327daa8379a5aef47a4686d135bbbe9bff616ea53680335ac9749707fi0",C7:baseURL+"83612dba4a98ad264e0244710a1b0279a1ff720c00bc9eae8016264c7413689ci0","D#7":baseURL+"a07fcf3ab7deb22623de77e00e7d5a973b3327215f74628771629a89df27cff8i0","F#7":baseURL+"d0e7f10af75b4c23893a552ee67901095c63d9c65d7a53a72f7ea9ee0561fdcei0",A7:baseURL+"680ed7115dc65938f198ee68efebbaa1ce50f8509dc016ad2cf1e602c1282c1bi0",C8:baseURL+"1fadb3bd08189ef3aa870e11644bad8d0fcced3d9cf58bc6fedf5043c1f14e99i0"},noteNames=Object.keys(SAMPLE_URL),Instrument=["AMSynth","DuoSynth","MembraneSynth","FMSynth","MonoSynth","Piano"],EDO=[3,5,7,12],txID=window.location.href.split("/").pop()||"default",hash="string"==typeof txID?txID.split("").reduce(((e,a)=>e+a.charCodeAt(0)),0):Math.floor(1e6*Math.random()),selectedInstrument=Instrument[hash%Instrument.length],selectedEDO=EDO[hash%EDO.length];toneshifts=Array.from({length:5},((e,a)=>a-2));const toneshift=toneshifts[hash%toneshifts.length],playbackSpeed=.7+hash%1e6/1e6*.8,nearbyEDOFreqs=Array.from({length:139},((e,a)=>a-70)).map((e=>{const a=e;return 440*Math.pow(2,a/selectedEDO)}));__webpack_require__(436)(collection,itemId,{toneshift,selectedEDO,selectedInstrument,nearbyEDOFreqs,toneshifts,playbackSpeed});const blobUrls={},synths=[],preparedTracks=[];async function playSong(e){let a=128/Tone.context.sampleRate*100;setInterval((()=>{const e=window.analyzer.getValue();window.fftWindows.push([...e]),window.fftWindows.length>512&&window.fftWindows.shift(),drawSpectrogram()}),a);preparedTracks.forEach((({synth:a,notes:n})=>{n.forEach((n=>{if("Piano"==selectedInstrument){const t=Tone.Frequency(n.name).toFrequency()*Math.pow(2,toneshift/12);a.triggerAttackRelease(t,n.duration/playbackSpeed,(n.time+e)/playbackSpeed,n.velocity)}else{const t=Tone.Frequency(n.name).toFrequency(),c=nearbyEDOFreqs.reduce(((e,a)=>Math.abs(a-t)<Math.abs(e-t)?a:e))*Math.pow(2,toneshift/selectedEDO);a.triggerAttackRelease(c,n.duration/playbackSpeed,(n.time+e)/playbackSpeed,n.velocity)}}))})),Tone.Transport.schedule((()=>{playSong(e+midi.duration)}),e+midi.duration)}function drawSpectrogram(e){const a=document.getElementById("spectrogram"),n=a.getContext("2d"),t=window.fftWindows;if(n.imageSmoothingEnabled=!1,!t||0===t.length)return void requestAnimationFrame(drawSpectrogram);const c=Tone.context.sampleRate,d=2*analyzer.size,o=Math.floor(6e3/c*d/2),s=t.length,r=1664525,i=1013904223,l=4294967296;seed=(r*hash+i)%l;let f=seed/l*360;seed=(r*seed+i)%l;let b=seed/l*360;const p=f,m=b,h=Math.floor(100*(f+b)/720*25)+75;document.body.style.backgroundColor=`hsl(${p}, ${h}%, 10%)`,n.clearRect(0,0,a.width,a.height),t.forEach(((e,t)=>{e.slice(0,o).forEach(((e,c)=>{const d=Math.min(Math.max(.7*(e+100)/100,0),1),o=(p+((m-p+180)%360-180)*d+360)%360,r=10+90*d;n.fillStyle=`hsl(${o}, ${h}%, ${r}%)`;const i=a.width/2-4*Math.floor(s/2)+4*t,l=a.height-4*(c+1);n.fillRect(i,l,4,4)}))})),requestAnimationFrame(drawSpectrogram)}!async function(){await Promise.all([fetch(TONEJS_URL).then((e=>e.text())),fetch(MIDI_URL).then((e=>e.text()))]).then((([tonejsCode,midiCode,toneuiCode])=>{eval(tonejsCode),eval(midiCode)})).catch((e=>{})),"Piano"===selectedInstrument&&(await Promise.all(noteNames.map((async e=>{const a=SAMPLE_URL[e],n=await fetch(a),t=await n.blob();blobUrls[e]=URL.createObjectURL(t)}))),samplerNotes=noteNames.reduce(((e,a)=>(e[a]=blobUrls[a],e)),{})),midi=await Midi.fromUrl(SRC_MIDI);const fftSize=2048;window.analyzer=new Tone.Analyser("fft",fftSize),window.fftWindows=[],midi.tracks.forEach((e=>{if(!("Piano"==selectedInstrument&&synths.length>1)){switch(selectedInstrument){case"FMSynth":var a=(new Tone.FMSynth).connect(window.analyzer).toMaster();break;case"AMSynth":a=(new Tone.AMSynth).connect(window.analyzer).toMaster();break;case"DuoSynth":a=(new Tone.DuoSynth).connect(window.analyzer).toMaster();break;case"MembraneSynth":a=(new Tone.MembraneSynth).connect(window.analyzer).toMaster();break;case"MonoSynth":a=(new Tone.MonoSynth).connect(window.analyzer).toMaster();break;case"Piano":a=new Tone.Sampler(samplerNotes).connect(window.analyzer).toMaster()}synths.push(a),preparedTracks.push({synth:a,notes:e.notes})}}));const waitForButton=setInterval((()=>{const e=document.querySelector("#playButton");e&&(clearInterval(waitForButton),e.addEventListener("click",(e=>{document.querySelector(".cover-controls").innerHTML='<div style="text-align:center">\n        <canvas id="spectrogram" width="512" height="512"></canvas>\n    </div>',playSong(Tone.now())})))}),100)}()})();