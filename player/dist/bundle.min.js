(()=>{var __webpack_modules__={436:(e,n)=>{e.exports=function(e,n,t){const a=`\n        <div class="cover-container">\n            <div class="cover-header">\n                <h1 class="collection-name">${e}</h1>\n                <h2 class="item-id">Item #${n}</h2>\n            </div>\n            <div class="cover-controls">\n                <button id="playButton" class="play-button">Play</button>\n            </div>\n            <div class="cover-details">\n                <div class="detail-item">\n                    <span class="label">Instrument:</span>\n                    <span class="value">${t.selectedInstrument}</span>\n                </div>\n                <div class="detail-item">\n                    <span class="label">EDO:</span>\n                    <span class="value">${t.selectedEDO}-tone</span>\n                </div>\n                <div class="detail-item">\n                    <span class="label">Tone Shift:</span>\n                    <span class="value">${t.toneshift} steps</span>\n                </div>\n                <div class="detail-item">\n                    <span class="label">Playback Speed:</span>\n                    <span class="value">x${t.playbackSpeed.toFixed(2)}</span>\n                </div>\n            </div>\n            \n        </div>\n        <style>\n            .cover-container {\n                width: 90vw;\n                max-width: 1200px;\n                margin: 5vh auto;\n                padding: clamp(20px, 5vw, 60px);\n                background: ${(()=>{const e=["#e9d5ff","#bfdbfe","#bbf7d0","#fed7aa","#fecaca"];return e[("number"==typeof t.toneshift?Math.abs(t.toneshift+t.selectedEDO):Math.floor(Math.random()*e.length))%e.length]})()};\n                box-shadow: 0 20px 40px rgba(0,0,0,0.15);\n                border-radius: clamp(12px, 2vw, 24px);\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                position: fixed;\n                top: 0;\n                left: 50%;\n                transform: translateX(-50%);\n            }\n            .cover-header {\n                text-align: center;\n            }\n            .collection-name {\n                font-size: clamp(1.8rem, 4vw, 3rem);\n                color: #2c3e50;\n                text-shadow: 1px 1px 2px rgba(0,0,0,0.1);\n                word-wrap: break-word;\n            }\n            .item-id {\n                font-size: clamp(1.2rem, 3vw, 1.8rem);\n                color: #7f8c8d;\n            }\n            .cover-details {\n                display: grid;\n                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n                gap: clamp(15px, 3vw, 30px);\n                margin: clamp(20px, 4vw, 40px) 0;\n            }\n            .detail-item {\n                padding: clamp(10px, 2vw, 20px);\n                background: rgba(255,255,255,0.8);\n                border-radius: clamp(8px, 1.5vw, 16px);\n                text-align: center;\n                box-shadow: 0 4px 6px rgba(0,0,0,0.05);\n                transition: transform 0.2s ease;\n            }\n            .detail-item:hover {\n                transform: translateY(-2px);\n            }\n            .label {\n                display: block;\n                font-size: clamp(0.8rem, 1.5vw, 1rem);\n                color: #95a5a6;\n                margin-bottom: clamp(4px, 1vw, 8px);\n                text-transform: uppercase;\n                letter-spacing: 1px;\n            }\n            .value {\n                font-size: clamp(1rem, 2vw, 1.4rem);\n                color: #34495e;\n                font-weight: bold;\n                word-wrap: break-word;\n            }\n            .cover-controls {\n                text-align: center;\n            }\n            .play-button {\n                padding: clamp(10px, 2vw, 15px) clamp(20px, 4vw, 40px);\n                font-size: clamp(1rem, 2vw, 1.4rem);\n                background: #2c3e50;\n                color: white;\n                border: none;\n                border-radius: clamp(6px, 1vw, 12px);\n                cursor: pointer;\n                transition: all 0.3s ease;\n                box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n            }\n            .play-button:hover {\n                background: #34495e;\n                transform: translateY(-2px);\n                box-shadow: 0 6px 8px rgba(0,0,0,0.15);\n            }\n            .play-button:disabled {\n                background: #95a5a6;\n                cursor: not-allowed;\n                transform: none;\n                box-shadow: none;\n            }\n            #Status {\n                margin-top: clamp(8px, 1.5vw, 15px);\n                color: #7f8c8d;\n                font-size: clamp(0.9rem, 1.5vw, 1.1rem);\n            }\n            @media (max-width: 480px) {\n                .cover-container {\n                    width: 95vw;\n                    margin: 2.5vh auto;\n                }\n                .cover-details {\n                    grid-template-columns: 1fr;\n                }\n            }\n        </style>\n    `;window.addEventListener("load",(()=>{document.body.innerHTML+=a}))}}},__webpack_module_cache__={};function __webpack_require__(e){var n=__webpack_module_cache__[e];if(void 0!==n)return n.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}var __webpack_exports__={};const scriptTag=document.getElementsByTagName("script")[0],tagId=scriptTag?scriptTag.getAttribute("id"):null,collection=scriptTag?scriptTag.getAttribute("collection"):null,itemId=scriptTag?scriptTag.getAttribute("item-id"):null,SRC_MIDI="./src/audio/vocals_melody.mid",TONEJS_URL="./src/js/Tone.js",MIDI_URL="./src/js/Midi.js",baseURL="https://tonejs.github.io/audio/salamander/",SAMPLE_URL={A0:baseURL+"A0.mp3",C1:baseURL+"C1.mp3","D#1":baseURL+"Ds1.mp3","F#1":baseURL+"Fs1.mp3",A1:baseURL+"A1.mp3",C2:baseURL+"C2.mp3","D#2":baseURL+"Ds2.mp3","F#2":baseURL+"Fs2.mp3",A2:baseURL+"A2.mp3",C3:baseURL+"C3.mp3","D#3":baseURL+"Ds3.mp3","F#3":baseURL+"Fs3.mp3",A3:baseURL+"A3.mp3",C4:baseURL+"C4.mp3","D#4":baseURL+"Ds4.mp3","F#4":baseURL+"Fs4.mp3",A4:baseURL+"A4.mp3",C5:baseURL+"C5.mp3","D#5":baseURL+"Ds5.mp3","F#5":baseURL+"Fs5.mp3",A5:baseURL+"A5.mp3",C6:baseURL+"C6.mp3","D#6":baseURL+"Ds6.mp3","F#6":baseURL+"Fs6.mp3",A6:baseURL+"A6.mp3",C7:baseURL+"C7.mp3","D#7":baseURL+"Ds7.mp3","F#7":baseURL+"Fs7.mp3",A7:baseURL+"A7.mp3",C8:baseURL+"C8.mp3"},noteNames=Object.keys(SAMPLE_URL),Instrument=["AMSynth","DuoSynth","MembraneSynth","FMSynth","MonoSynth","Piano"],EDO=[5,7,12],txID=window.location.href.split("/").pop()||"default",hash="string"==typeof txID?txID.split("").reduce(((e,n)=>e+n.charCodeAt(0)),0):Math.floor(1e6*Math.random()),selectedInstrument=Instrument[hash%Instrument.length],selectedEDO=EDO[hash%EDO.length];toneshifts=Array.from({length:5},((e,n)=>n-2));const toneshift=toneshifts[hash%toneshifts.length],playbackSpeed=.7+hash%1e6/1e6*.8,nearbyEDOFreqs=Array.from({length:139},((e,n)=>n-70)).map((e=>{const n=e;return 440*Math.pow(2,n/selectedEDO)}));__webpack_require__(436)(collection,itemId,{toneshift,selectedEDO,selectedInstrument,nearbyEDOFreqs,toneshifts,playbackSpeed});const blobUrls={},synths=[],preparedTracks=[];async function playSong(e){let n=128/Tone.context.sampleRate*100;setInterval((()=>{const e=window.analyzer.getValue();window.fftWindows.push([...e]),window.fftWindows.length>512&&window.fftWindows.shift(),drawSpectrogram()}),n);preparedTracks.forEach((({synth:n,notes:t})=>{t.forEach((t=>{if("Piano"==selectedInstrument){const a=Tone.Frequency(t.name).toFrequency()*Math.pow(2,toneshift/12);n.triggerAttackRelease(a,t.duration/playbackSpeed,(t.time+e)/playbackSpeed,t.velocity)}else{const a=Tone.Frequency(t.name).toFrequency(),s=nearbyEDOFreqs.reduce(((e,n)=>Math.abs(n-a)<Math.abs(e-a)?n:e))*Math.pow(2,toneshift/selectedEDO);n.triggerAttackRelease(s,t.duration/playbackSpeed,(t.time+e)/playbackSpeed,t.velocity)}}))})),Tone.Transport.schedule((()=>{playSong(e+midi.duration)}),e+midi.duration)}function drawSpectrogram(e){const n=document.getElementById("spectrogram"),t=n.getContext("2d"),a=window.fftWindows;if(t.imageSmoothingEnabled=!1,!a||0===a.length)return void requestAnimationFrame(drawSpectrogram);const s=Tone.context.sampleRate,o=2*analyzer.size,r=Math.floor(6e3/s*o/2),c=a.length,i=1664525,l=1013904223,p=4294967296;seed=(i*hash+l)%p;let d=seed/p*360;seed=(i*seed+l)%p;let m=seed/p*360;const h=d,b=m,w=Math.floor(100*(d+m)/720*25)+75;document.body.style.backgroundColor=`hsl(${h}, ${w}%, 10%)`,t.clearRect(0,0,n.width,n.height),a.forEach(((e,a)=>{e.slice(0,r).forEach(((e,s)=>{const o=Math.min(Math.max(.7*(e+100)/100,0),1),r=(h+((b-h+180)%360-180)*o+360)%360,i=10+90*o;t.fillStyle=`hsl(${r}, ${w}%, ${i}%)`;const l=n.width/2-4*Math.floor(c/2)+4*a,p=n.height-4*(s+1);t.fillRect(l,p,4,4)}))})),requestAnimationFrame(drawSpectrogram)}!async function(){await Promise.all([fetch(TONEJS_URL).then((e=>e.text())),fetch(MIDI_URL).then((e=>e.text()))]).then((([tonejsCode,midiCode,toneuiCode])=>{eval(tonejsCode),eval(midiCode)})).catch((e=>{})),"Piano"===selectedInstrument&&(await Promise.all(noteNames.map((async e=>{const n=SAMPLE_URL[e],t=await fetch(n),a=await t.blob();blobUrls[e]=URL.createObjectURL(a)}))),samplerNotes=noteNames.reduce(((e,n)=>(e[n]=blobUrls[n],e)),{})),midi=await Midi.fromUrl(SRC_MIDI);const fftSize=2048;window.analyzer=new Tone.Analyser("fft",fftSize),window.fftWindows=[],midi.tracks.forEach((e=>{if(!("Piano"==selectedInstrument&&synths.length>1)){switch(selectedInstrument){case"FMSynth":var n=(new Tone.FMSynth).connect(window.analyzer).toMaster();break;case"AMSynth":n=(new Tone.AMSynth).connect(window.analyzer).toMaster();break;case"DuoSynth":n=(new Tone.DuoSynth).connect(window.analyzer).toMaster();break;case"MembraneSynth":n=(new Tone.MembraneSynth).connect(window.analyzer).toMaster();break;case"MonoSynth":n=(new Tone.MonoSynth).connect(window.analyzer).toMaster();break;case"Piano":n=new Tone.Sampler(samplerNotes).connect(window.analyzer).toMaster()}synths.push(n),preparedTracks.push({synth:n,notes:e.notes})}}));const waitForButton=setInterval((()=>{const e=document.querySelector("#playButton");e&&(clearInterval(waitForButton),e.addEventListener("click",(e=>{document.querySelector(".cover-controls").innerHTML='<div style="text-align:center">\n        <canvas id="spectrogram" width="512" height="512"></canvas>\n    </div>',playSong(Tone.now())})))}),100)}()})();